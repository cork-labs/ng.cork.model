!function(a){"use strict";var b=a.module("ng.cork.model.factory",["ng.cork.util"]),c=a.copy,d=a.isString,e=a.isFunction,f=a.isObject;b.service("corkModelFactory",["$injector","corkUtil",function(b,g){function h(a,b){var f,g,h,i;if(!m(b))throw new Error('Invalid options for model "'+a+'".');if(b=c(b),b.name=a,f=b.hasOwnProperty("$constructor"),g=b.hasOwnProperty("$new"),h=f&&(d(b.$constructor)||e(b.$constructor)),i=g&&e(b.$new),f&&!h||g&&!i||!g&&!f)throw new Error('Invalid "$constructor" or "$new" in options for model "'+a+'".');if(b.service=b.service||null,b.methods=b.methods||{},!m(b.methods))throw new Error('Invalid "methods" in options for model "'+a+'".');return b}function i(a){var b,c,g=a.methods;for(c in g){if(b=g[c],null===b||d(b)||e(b))b=g[c]={method:b};else if(!f(b))throw new Error('Invalid options for method of model "'+a.name+'".');if(b.name=c,!d(b.name)||!b.name.length)throw new Error('Invalid method name in options of model "'+a.name+'".');if(b.hasOwnProperty("method")&&null!==b.method&&!e(b.method)&&!d(b.method))throw new Error('Invalid "method" in options for method "'+b.name+'" of model "'+a.name+'".');if(!e(b.method)&&(b.service=b.service||a.service,b.method=b.method||b.name,b.andThen=b.andThen||a.andThen||null,!b.service||!m(b.service)&&!d(b.service)))throw new Error('Invalid "service" in options for method "'+b.name+'" of model "'+a.name+'".')}}function j(a,b){var c;return c=b.$new?function(c){var d=b.$new(c);return k(a,b,d),d}:function(c){d(b.$constructor)&&(b.$constructor=a.get(b.$constructor));var e=b.$constructor,f=new e(c);return k(a,b,f),f},c.model=b,c}function k(b,c,d){var f,g,h,i=c.methods;for(g in i)f=i[g],h=e(f.method)?a.bind(d,f.method):l(b,d,f),Object.defineProperty(d,f.name,{enumerable:!1,configurable:!1,value:h})}function l(a,b,c){return d(c.service)&&(c.service=a.get(c.service)),function(){var a=[].slice.call(arguments);a.unshift(b);var d=c.service[c.method].apply(c.service,a);return n(d)&&c.andThen&&d.then(function(a){return b[c.andThen](a),a}),d}}var m=g.isObjectObject,n=g.isPromise;return{make:function(a,c){return c=h(a,c),i(c),j(b,c)}}}])}(angular);